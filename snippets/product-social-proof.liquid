{%- liquid
  comment
    Product Social Proof - Visitors Counter
    Displays dynamic "X people viewing" badge for urgency/FOMO
    Number is deterministic (product.id based) but appears dynamic
  endcomment

  assign product_id_number = product.id | split: '/' | last | plus: 0
  assign base_viewers = 8
  assign variation = product_id_number | modulo: 17
  assign total_viewers = base_viewers | plus: variation

  comment
    Formula: 8 + (product_id % 17) = range 8-24 viewers
    - Avoids 0-5 (not credible)
    - Avoids >30 (suspicious for niche products)
    - Deterministic: same product always shows same number
    - Appears dynamic across different products
  endcomment
-%}

<div class="product-social-proof-badge">
  <div class="social-proof-badge__content">
    <svg class="social-proof-badge__icon" width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">
      <circle cx="5" cy="6" r="2.5" fill="#4770DB"/>
      <circle cx="11" cy="6" r="2.5" fill="#4770DB"/>
      <path d="M3 14c0-2.5 1.5-4 4-4h2c2.5 0 4 1.5 4 4" stroke="#4770DB" stroke-width="1.5" stroke-linecap="round"/>
    </svg>
    <span class="social-proof-badge__text">
      <span class="social-proof-badge__count">{{ total_viewers }}</span> people are viewing this right now
    </span>
  </div>
  <span class="social-proof-badge__pulse"></span>
</div>

<style>
.product-social-proof-badge {
  position: relative;
  display: inline-flex;
  align-items: center;
  gap: 8px;
  padding: 8px 14px;
  background: linear-gradient(135deg, #eff6ff 0%, #f0f9ff 100%);
  border: 1px solid #bfdbfe;
  border-radius: 8px;
  margin-bottom: 16px;
  overflow: hidden;
}

.social-proof-badge__content {
  display: flex;
  align-items: center;
  gap: 8px;
  position: relative;
  z-index: 2;
}

.social-proof-badge__icon {
  flex-shrink: 0;
}

.social-proof-badge__text {
  font-size: 13px;
  color: #1e40af;
  font-weight: 500;
  line-height: 1.4;
}

.social-proof-badge__count {
  font-weight: 600;
  color: #1e3a8a;
}

.social-proof-badge__pulse {
  position: absolute;
  top: 50%;
  left: 12px;
  width: 8px;
  height: 8px;
  background: #4770DB;
  border-radius: 50%;
  transform: translateY(-50%);
  animation: pulse-animation 2s ease-in-out infinite;
  z-index: 1;
}

@keyframes pulse-animation {
  0%, 100% {
    opacity: 1;
    transform: translateY(-50%) scale(1);
  }
  50% {
    opacity: 0.4;
    transform: translateY(-50%) scale(1.3);
  }
}

@media screen and (max-width: 749px) {
  .product-social-proof-badge {
    font-size: 12px;
    padding: 7px 12px;
  }

  .social-proof-badge__text {
    font-size: 12px;
  }
}
</style>
